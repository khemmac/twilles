
Ext.define('TCMS.PartStyle.Grid',{extend:'BASE.Grid',constructor:function(config){return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:'part_style'}},fields:[{name:'id',type:'string'},{name:'part_type',type:'string'},'name',{name:'conflict_type',type:'string'},{name:'remark',type:'string'},{name:'is_active',type:'boolean'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Code",width:110,dataIndex:'id',sortable:true,align:'left'},{text:"Type",width:70,dataIndex:'part_type',sortable:true,align:'left',renderer:function(v){var types={COLLAR:'Collar',CUFF:'Cuff',PLACKET:'Placket',POCKET:'Pocket',BOTTOM:'Bottom',YOKE:'Yoke',PLEAT:'Pleat'};return types[v];}},{text:"Name",width:120,dataIndex:'name',sortable:true,align:'left'},{text:"Conflict type",width:160,dataIndex:'conflict_type',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.bbar={xtype:'pagingtoolbar',store:this.store,displayInfo:true};this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.PartStyle.Main',{extend:'Ext.panel.Panel',constructor:function(config){Ext.apply(this,{layout:'border'});return this.callParent(arguments);},initComponent:function(){var addAct=Ext.create('BASE.Action',{text:'Add',iconCls:'b-application_add'});var editAct=Ext.create('BASE.ActionSingle',{text:'Edit',iconCls:'b-application_edit'});var activeAct=Ext.create('BASE.ActionMultiple',{text:'Active',iconCls:'b-flag-green'});var inActiveAct=Ext.create('BASE.ActionMultiple',{text:'Inactive',iconCls:'b-flag-red'});var contextMenu=new Ext.menu.Menu({items:[addAct,editAct,'-',activeAct,inActiveAct]});var window=Ext.create('TCMS.PartStyle.Window');var grid=Ext.create('TCMS.PartStyle.Grid',{region:'center',border:false,tbar:[addAct,editAct,'-',activeAct,inActiveAct],validateActions:[addAct,editAct,activeAct,inActiveAct]});this.items=[grid];addAct.setHandler(function(){window.openDialog('Add part style','add',grid,{type:'part_style'});});editAct.setHandler(function(){window.openDialog('Edit part style','edit',grid,{id:grid.getSelectedId(),type:'part_style'});});activeAct.setHandler(function(){window.openDialog('Active','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:1});});inActiveAct.setHandler(function(){window.openDialog('Inactive','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:0});});grid.on('celldblclick',function(g,td,cellIndex,r){if(!editAct.isDisabled())
editAct.execute();});grid.on('cellcontextmenu',function(g,td,cellIndex,r,tr,rowIndex,e){e.preventDefault();contextMenu.showAt(e.xy);});window.form.on('afterSave',function(){window.hide();grid.load();});window.form.on('afterSetStatus',function(){window.hide();grid.load();});grid.load();return this.callParent(arguments);}});;Ext.define('TCMS.PartStyle.Window',{extend:'BASE.Window',requires:['BASE.Window'],constructor:function(config){Ext.apply(this,{title:'Login',height:320,width:400,resizable:false,modal:true,layout:'border',buttonAlign:'center'});return this.callParent(arguments);},initComponent:function(){var _this=this;var uxFormStatus=Ext.create('BASE.ux.FormStatus',{moduleType:'inventory'});this.comboPartType=Ext.create('BASE.ComboStatic',{fieldLabel:'Part type',name:'part_type',store:[['COLLAR','Collar'],['CUFF','Cuff'],['PLACKET','Placket'],['POCKET','Pocket'],['BOTTOM','Bottom'],['YOKE','Yoke'],['PLEAT','Pleat']]});this.comboConflictType=Ext.create('BASE.ComboAjax',{fieldLabel:'Conflict color',name:'conflict_type',proxyUrl:__site_url+'backend/enum/LoadListCombo_ConflictType',proxyFields:['value','text'],proxyIdProperty:'value',displayField:'text',valueField:'value'});this.form=Ext.create('BASE.Form',{region:'center',defaults:{labelWidth:100,labelAlign:'right',width:300},items:[{name:'id',xtype:'textfield',fieldLabel:'Code',allowBlank:false},this.comboPartType,this.comboConflictType,{name:'name',xtype:'textfield',fieldLabel:'Name',allowBlank:false},{name:'remark',xtype:'textarea',fieldLabel:'Remark'},{name:'is_active',xtype:'checkboxfield',fieldLabel:'Active',checked:!0}],plugins:[uxFormStatus],mapping:function(o){o.is_active=(o.is_active&&o.is_active=='on')?1:0;return o;},getSaveParams:function(){return Ext.apply({},this.formParams);},getSaveUrl:function(){return __site_url+'backend/icode/'+((_this.dialogAction=="add")?'insert':'update');},getLoadParams:function(){return Ext.apply({},this.formParams);},getLoadUrl:function(){return __site_url+'backend/dao/load';}});this.submitAct=Ext.create('BASE.Action',{text:'Submit'});this.cancelAct=Ext.create('BASE.Action',{text:'Cancel'});this.buttons=[new Ext.button.Button(this.submitAct),new Ext.button.Button(this.cancelAct)];this.items=[this.form];this.submitAct.setHandler(function(){_this.form.saveData();});this.cancelAct.setHandler(function(){_this.hide();});this.form.on('form_key_enter',function(){_this.submitAct.execute();});this.on("show",function(){_this.form.getEl().scrollTo('top',0,false);_this.form.formParams=_this.dialogParams;_this.form.formAction=_this.dialogAction;_this.actions[_this.dialogAction].call(_this);});this.comboConflictType.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){var partType=_this.comboPartType.getValue();Ext.apply(opts.params,{part_type:partType});}});this.comboPartType.on('change',function(){_this.comboConflictType.reset();_this.comboConflictType.store.load();});return this.callParent(arguments);},actions:{"add":function(){this.form.form.reset();},"edit":function(){this.form.form.reset();this.form.loadData();},"delete":function(){var _this=this;this.hide(null,function(){_this.form.deleteData();});},"setStatus":function(){var _this=this;this.hide(null,function(){_this.form.setStatus();});}}});;Ext.define('TCMS.Authen.LoginWindow',{extend:'BASE.Window',requires:['BASE.Window'],constructor:function(config){Ext.apply(this,{title:'Login',closeAction:'hide',height:300,minHeight:300,width:380,minWidth:380,resizable:false,modal:true,layout:'border',closable:false,buttonAlign:'center'});return this.callParent(arguments);},initComponent:function(){var _this=this;this.form=Ext.create('TCMS.Authen.LoginForm',{region:'center'});this.submitAct=new Ext.Action({text:'Login',iconCls:'b-small-key',animate:true});this.buttons=[new Ext.button.Button(this.submitAct)];this.items=[{xtype:'panel',region:'north',height:150,border:false,html:['<div style="height:120px;">','<div style="height:120px; background-color:rgba(34, 45, 58, 0.9); text-align:center;">','<img src="'+__base_url+'assets/images/logo/logo.svg" style="width:120px; margin-top:20px;" />','</div>','</div>'].join('')},this.form];this.submitAct.setHandler(function(){_this.form.submit(function(err,result){if(err)
Ext.Msg.alert('Failure',err);else
Ext.Msg.alert('Success',result);});});this.form.on('form_key_enter',function(){_this.submitAct.execute();});return this.callParent(arguments);}});;Ext.define('TCMS.Authen.LoginForm',{extend:'BASE.Form',constructor:function(config){Ext.apply(this,{border:false,bodyStyle:'padding:5px 0px 5px 0px;',waitMsgTarget:true,defaults:{labelWidth:100,width:300}});return this.callParent(arguments);},initComponent:function(){var _this=this;this.items=[{xtype:'textfield',fieldLabel:'Username',name:"username",emptyText:'',labelAlign:'right',allowBlank:false,listeners:{specialkey:function(o,e){if(e.getKey()==e.ENTER)
_this.fireEvent('form_key_enter');}}},{xtype:'textfield',inputType:'password',fieldLabel:'Password',name:"password",emptyText:'',labelAlign:'right',allowBlank:false,listeners:{specialkey:function(o,e){if(e.getKey()==e.ENTER)
_this.fireEvent('form_key_enter');}}}];return this.callParent(arguments);},submit:function(){var _this=this,formBasic=this.getForm();if(formBasic.isValid()){var progress=Ext.Msg.show({msg:'Processing login, please wait...',closable:false,draggable:false,toFrontOnShow:true,progress:true,wait:true,waitConfig:{interval:250,animate:true,text:'Loggin in...'}});formBasic.submit({clientValidation:true,waitMsg:'Loging in...',url:__site_url+'admin/do_login',success:function(formBasic,action){_this.fireEvent('login_success',action.result.msg);},failure:function(formBasic,action){var showError=function(title,msg){Ext.Msg.show({title:title,msg:msg,buttons:Ext.Msg.OK,icon:Ext.MessageBox.ERROR});};switch(action.failureType){case Ext.form.action.Action.CLIENT_INVALID:showError('Failure','Form fields may not be submitted with invalid values');break;case Ext.form.action.Action.CONNECT_FAILURE:showError('Failure','Ajax communication failed');break;case Ext.form.action.Action.SERVER_INVALID:showError('Failure',action.result.msg);}}});}},getValues:function(){return this.getForm().getValues();},reset:function(){this.getForm().reset();}});;Ext.define('TCMS.BaseMaster.Grid',{extend:'BASE.Grid',moduleType:null,constructor:function(config){return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:_this.moduleType}},fields:[{name:'id',type:'int'},'name','alias',{name:'is_active',type:'boolean'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Name",width:120,dataIndex:'name',sortable:true,align:'left'},{text:"Alias",width:80,dataIndex:'alias',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.bbar={xtype:'pagingtoolbar',store:this.store,displayInfo:true};this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.BaseMaster.field.Numeric',{extend:'BASE.field.NumericField',decimalPrecision:2,constructor:function(config){return this.callParent(arguments);},initComponent:function(){return this.callParent(arguments);}});;Ext.define('TCMS.BaseMaster.field.ComboPart',{extend:'BASE.ComboAjax',proxyUrl:__site_url+'backend/dao/LoadList',proxyFields:['id','name'],proxyIdProperty:'id',displayField:'name',valueField:'id',partType:null,constructor:function(config){Ext.apply(this,{proxyExtraParams:{type:'part_style',filter:Ext.encode({part_type:config.partType})}});return this.callParent(arguments);},initComponent:function(){return this.callParent(arguments);}});;Ext.define('TCMS.BaseMaster.field.ComboInventory',{extend:'BASE.ComboAjax',proxyUrl:__site_url+'backend/dao/LoadList',proxyFields:['id','name'],proxyIdProperty:'id',displayField:'name',valueField:'id',partType:null,constructor:function(config){Ext.apply(this,{proxyExtraParams:{type:'inventory',filter:Ext.encode({inventory_type:config.inventoryType})}});return this.callParent(arguments);},initComponent:function(){return this.callParent(arguments);}});;Ext.define('TCMS.BaseMaster.Main',{extend:'Ext.panel.Panel',moduleType:null,moduleTitle:null,constructor:function(config){Ext.apply(this,{layout:'border'});return this.callParent(arguments);},initComponent:function(){var _this=this;var l=this.moduleType.length;var addAct=Ext.create('BASE.Action',{text:'Add',iconCls:'b-application_add'});var editAct=Ext.create('BASE.ActionSingle',{text:'Edit',iconCls:'b-application_edit'});var activeAct=Ext.create('BASE.ActionMultiple',{text:'Active',iconCls:'b-flag-green'});var inActiveAct=Ext.create('BASE.ActionMultiple',{text:'Inactive',iconCls:'b-flag-red'});var contextMenu=new Ext.menu.Menu({items:[addAct,editAct,'-',activeAct,inActiveAct]});var window=Ext.create('TCMS.BaseMaster.Window',{moduleType:this.moduleType});var grid=Ext.create('TCMS.BaseMaster.Grid',{moduleType:this.moduleType,region:'center',border:false,tbar:[addAct,editAct,'-',activeAct,inActiveAct],validateActions:[addAct,editAct,activeAct,inActiveAct]});this.items=[grid];addAct.setHandler(function(){window.openDialog('Add '+_this.moduleTitle,'add',grid,{type:_this.moduleType});});editAct.setHandler(function(){window.openDialog('Edit '+_this.moduleTitle,'edit',grid,{id:grid.getSelectedId(),type:_this.moduleType});});activeAct.setHandler(function(){window.openDialog('Active','setStatus',grid,{ids:grid.getSelectionsId().join(','),type:_this.moduleType,is_active:1});});inActiveAct.setHandler(function(){window.openDialog('Inactive','setStatus',grid,{ids:grid.getSelectionsId().join(','),type:_this.moduleType,is_active:0});});grid.on('celldblclick',function(g,td,cellIndex,r){if(!editAct.isDisabled())
editAct.execute();});grid.on('cellcontextmenu',function(g,td,cellIndex,r,tr,rowIndex,e){e.preventDefault();contextMenu.showAt(e.xy);});window.form.on('afterSave',function(){window.hide();grid.load();});window.form.on('afterSetStatus',function(){window.hide();grid.load();});grid.load();return this.callParent(arguments);}});;Ext.define('TCMS.BaseMaster.Window',{extend:'BASE.Window',requires:['BASE.Window'],moduleType:null,constructor:function(config){Ext.apply(this,{height:180,width:300,resizable:false,modal:true,layout:'border',buttonAlign:'center'});return this.callParent(arguments);},initComponent:function(){var _this=this;var uxFormStatus=Ext.create('BASE.ux.FormStatus',{moduleType:this.moduleType});this.form=Ext.create('BASE.Form',{region:'center',defaults:{labelWidth:60,labelAlign:'right',width:250},items:[{name:'name',xtype:'textfield',fieldLabel:'Name',allowBlank:false},{name:'alias',xtype:'textfield',fieldLabel:'Alias',allowBlank:false},{name:'is_active',xtype:'checkboxfield',fieldLabel:'Active',checked:!0}],plugins:[uxFormStatus],mapping:function(o){o.is_active=(o.is_active&&o.is_active=='on')?1:0;return o;},getSaveParams:function(){return Ext.apply({type:_this.moduleType},this.formParams);},getSaveUrl:function(){return __site_url+'backend/dao/'+((_this.dialogAction=="add")?'insert':'update');},getLoadParams:function(){return Ext.apply({type:_this.moduleType},this.formParams);},getLoadUrl:function(){return __site_url+'backend/dao/load';},getSetStatusParams:function(){return Ext.apply({type:_this.moduleType},this.formParams);},getSetStatusUrl:function(){return __site_url+'backend/istatus/set';},setStatus:function(){var _this=this;var url=form.getSetStatusUrl();_this.form.load({url:url,clientValidation:true,success:function(form,act){_this.fireEvent('afterSetStatus',_this,act);},failure:_this.failureAlert,waitMsg:'Changing status...',waitTitle:'Please wait...',params:_this.getSetStatusParams()});}});this.submitAct=Ext.create('BASE.Action',{text:'Submit'});this.cancelAct=Ext.create('BASE.Action',{text:'Cancel'});this.buttons=[new Ext.button.Button(this.submitAct),new Ext.button.Button(this.cancelAct)];this.items=[this.form];this.submitAct.setHandler(function(){_this.form.saveData();});this.cancelAct.setHandler(function(){_this.hide();});this.on("show",function(){_this.form.getEl().scrollTo('top',0,false);_this.form.formParams=_this.dialogParams;_this.form.formAction=_this.dialogAction;_this.actions[_this.dialogAction].call(_this);});return this.callParent(arguments);},actions:{"add":function(){this.form.form.reset();},"edit":function(){this.form.form.reset();this.form.loadData();},"delete":function(){var _this=this;this.hide(null,function(){_this.form.deleteData();});},"setStatus":function(){var _this=this;this.hide(null,function(){_this.form.setStatus();});}}});;Ext.define('TCMS.MainViewport',{extend:'Ext.Viewport',layout:{type:'border',padding:5},defaults:{split:true},constructor:function(config){return this.callParent(arguments);},initComponent:function(){var northPanel=new Ext.Panel({region:'north',border:false,tbar:[{xtype:'buttongroup',columns:3,title:'Master data',items:[{text:'Fabric',scale:'large',rowspan:3,iconCls:'menu-large-fabric',iconAlign:'top',cls:'x-btn-as-arrow',hrefTarget:'_self',href:__site_url+'cms/fabric'},{text:'Color',iconCls:'menu-small-color',hrefTarget:'_self',href:__site_url+'cms/color'},{text:'Pattern',iconCls:'menu-small-pattern',hrefTarget:'_self',href:__site_url+'cms/pattern'},{text:'Texture',iconCls:'menu-small-texture',hrefTarget:'_self',href:__site_url+'cms/texture'},{text:'Supplier',iconCls:'menu-small-supplier',hrefTarget:'_self',href:__site_url+'cms/supplier'},{text:'Thread count',iconCls:'menu-small-thread_count',hrefTarget:'_self',href:__site_url+'cms/thread_count'},{text:'Inventory',iconCls:'menu-small-inventory',hrefTarget:'_self',href:__site_url+'cms/inventory'}]},{xtype:'buttongroup',columns:3,title:'Style data',layout:{type:'hbox',padding:'5 3 4 3',align:'stretch'},items:[{text:'Style collection',scale:'large',iconCls:'menu-large-shirt',iconAlign:'top',cls:'x-btn-as-arrow',hrefTarget:'_self',href:__site_url+'cms/style_collection'},{text:'Part style',scale:'large',iconCls:'menu-large-part_style',iconAlign:'top',cls:'x-btn-as-arrow',hrefTarget:'_self',href:__site_url+'cms/part_style'}]}]});this.items.push(northPanel);return this.callParent(arguments);}});;Ext.define('TCMS.Color.Grid',{extend:'BASE.Grid',constructor:function(config){return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:'color'}},fields:[{name:'id',type:'int'},'name','alias',{name:'is_active',type:'int'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Name",width:120,dataIndex:'name',sortable:true,align:'left'},{text:"Alias",width:80,dataIndex:'alias',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.bbar={xtype:'pagingtoolbar',store:this.store,displayInfo:true};this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.Color.Main',{extend:'Ext.panel.Panel',constructor:function(config){Ext.apply(this,{layout:'border',border:false});return this.callParent(arguments);},initComponent:function(){var addAct=Ext.create('BASE.Action',{text:'Add',iconCls:'b-application_add'});var editAct=Ext.create('BASE.ActionSingle',{text:'Edit',iconCls:'b-application_edit'});var activeAct=Ext.create('BASE.ActionMultiple',{text:'Active',iconCls:'b-flag-green'});var inActiveAct=Ext.create('BASE.ActionMultiple',{text:'Inactive',iconCls:'b-flag-red'});var contextMenu=new Ext.menu.Menu({items:[addAct,editAct,'-',activeAct,inActiveAct]});var window=Ext.create('TCMS.Color.Window');var grid=Ext.create('TCMS.Color.Grid',{region:'center',tbar:[addAct,editAct,'-',activeAct,inActiveAct],validateActions:[addAct,editAct,activeAct,inActiveAct]});this.items=[grid];addAct.setHandler(function(){window.openDialog('Add color','add',grid,{type:'color'});});editAct.setHandler(function(){window.openDialog('Edit color','edit',grid,{id:grid.getSelectedId(),type:'color'});});activeAct.setHandler(function(){window.openDialog('Active','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:1});});inActiveAct.setHandler(function(){window.openDialog('Inactive','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:0});});grid.on('celldblclick',function(g,td,cellIndex,r){if(!editAct.isDisabled())
editAct.execute();});grid.on('cellcontextmenu',function(g,td,cellIndex,r,tr,rowIndex,e){e.preventDefault();contextMenu.showAt(e.xy);});window.form.on('afterSave',function(){window.hide();grid.load();});window.form.on('afterSetStatus',function(){window.hide();grid.load();});grid.load();return this.callParent(arguments);}});;Ext.define('TCMS.Color.Window',{extend:'BASE.Window',requires:['BASE.Window'],constructor:function(config){Ext.apply(this,{title:'Login',height:180,width:300,resizable:false,modal:true,layout:'border',buttonAlign:'center'});return this.callParent(arguments);},initComponent:function(){var _this=this;var uxFormStatus=Ext.create('BASE.ux.FormStatus',{moduleType:'color'});this.form=Ext.create('BASE.Form',{region:'center',defaults:{labelWidth:60,labelAlign:'right',width:250},items:[{name:'name',xtype:'textfield',fieldLabel:'Name',allowBlank:false},{name:'alias',xtype:'textfield',fieldLabel:'Alias',allowBlank:false},{name:'is_active',xtype:'checkboxfield',fieldLabel:'Active',checked:!0}],plugins:[uxFormStatus],mapping:function(o){o.is_active=(o.is_active&&o.is_active=='on')?1:0;return o;},getSaveParams:function(){return Ext.apply({type:'color'},this.formParams);},getSaveUrl:function(){return __site_url+'backend/dao/'+((_this.dialogAction=="add")?'insert':'update');},getLoadParams:function(){return Ext.apply({type:'color'},this.formParams);},getLoadUrl:function(){return __site_url+'backend/dao/load';}});this.submitAct=Ext.create('BASE.Action',{text:'Submit'});this.cancelAct=Ext.create('BASE.Action',{text:'Cancel'});this.buttons=[new Ext.button.Button(this.submitAct),new Ext.button.Button(this.cancelAct)];this.items=[this.form];this.submitAct.setHandler(function(){_this.form.saveData();});this.cancelAct.setHandler(function(){_this.hide();});this.form.on('form_key_enter',function(){_this.submitAct.execute();});this.on("show",function(){_this.form.getEl().scrollTo('top',0,false);_this.form.formParams=_this.dialogParams;_this.form.formAction=_this.dialogAction;_this.actions[_this.dialogAction].call(_this);});return this.callParent(arguments);},actions:{"add":function(){this.form.form.reset();},"edit":function(){this.form.form.reset();this.form.loadData();},"delete":function(){var _this=this;this.hide(null,function(){_this.form.deleteData();});},"setStatus":function(){var _this=this;this.hide(null,function(){_this.form.setStatus();});}}});;Ext.define('TCMS.Fabric.Grid',{extend:'BASE.Grid',constructor:function(config){return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:'v_fabric'}},fields:[{name:'id',type:'string'},{name:'fabric_type',type:'int'},{name:'fabric_type_name',type:'string'},'name','alias',{name:'supplier_id',type:'int'},{name:'supplier_name',type:'string'},{name:'stock_type',type:'int'},{name:'stock_type_name',type:'string'},{name:'primary_color_id',type:'int'},{name:'primary_color_name',type:'string'},{name:'secondary_color_id',type:'int'},{name:'secondary_color_name',type:'string'},{name:'tertiary_color_id',type:'int'},{name:'tertiary_color_name',type:'string'},{name:'true_color_id',type:'int'},{name:'true_color_name',type:'string'},{name:'pattern_id',type:'int'},{name:'pattern_name',type:'string'},{name:'texture_id',type:'int'},{name:'texture_name',type:'string'},{name:'thread_count_id',type:'int'},{name:'thread_count_name',type:'string'},{name:'length_yards',type:'float'},{name:'price',type:'float'},{name:'cost',type:'float'},{name:'is_active',type:'boolean'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Code",width:80,dataIndex:'id',sortable:true,align:'left'},{text:"Fabric Type",width:80,dataIndex:'fabric_type_name',sortable:true,align:'left'},{text:"Supplier",width:100,dataIndex:'supplier_name',sortable:true,align:'left'},{text:"Stock Type",width:80,dataIndex:'stock_type_name',sortable:true,align:'left'},{text:"Primary color",width:80,dataIndex:'primary_color_name',sortable:true,align:'left'},{text:"Secondary color",width:80,dataIndex:'secondary_color_name',sortable:true,align:'left'},{text:"Tertiary color",width:80,dataIndex:'tertiary_color_name',sortable:true,align:'left'},{text:"True color",width:80,dataIndex:'true_color_name',sortable:true,align:'left'},{text:"Pattern",width:80,dataIndex:'pattern_name',sortable:true,align:'left'},{text:"Texture",width:80,dataIndex:'texture_name',sortable:true,align:'left'},{text:"Thread count",width:80,dataIndex:'thread_count_name',sortable:true,align:'left'},{text:"Length(yard)",width:80,dataIndex:'length_yards',sortable:true,align:'left'},{text:"Price",width:60,dataIndex:'price',sortable:true,align:'left'},{text:"cost",width:60,dataIndex:'cost',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.bbar={xtype:'pagingtoolbar',store:this.store,displayInfo:true};this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.Fabric.Main',{extend:'Ext.panel.Panel',constructor:function(config){Ext.apply(this,{layout:'border',border:false});return this.callParent(arguments);},initComponent:function(){var addAct=Ext.create('BASE.Action',{text:'Add',iconCls:'b-application_add'});var editAct=Ext.create('BASE.ActionSingle',{text:'Edit',iconCls:'b-application_edit'});var activeAct=Ext.create('BASE.ActionMultiple',{text:'Active',iconCls:'b-flag-green'});var inActiveAct=Ext.create('BASE.ActionMultiple',{text:'Inactive',iconCls:'b-flag-red'});var contextMenu=new Ext.menu.Menu({items:[addAct,editAct,'-',activeAct,inActiveAct]});var window=Ext.create('TCMS.Fabric.Window');var grid=Ext.create('TCMS.Fabric.Grid',{region:'center',tbar:[addAct,editAct,'-',activeAct,inActiveAct],validateActions:[addAct,editAct,activeAct,inActiveAct]});this.items=[grid];addAct.setHandler(function(){window.openDialog('Add Fabric','add',grid,{type:'fabric'});});editAct.setHandler(function(){window.openDialog('Edit Fabric','edit',grid,{id:grid.getSelectedId(),type:'fabric'});});activeAct.setHandler(function(){window.openDialog('Active','setStatus',grid,{ids:grid.getSelectionsId().join(','),type:'fabric',is_active:1});});inActiveAct.setHandler(function(){window.openDialog('Inactive','setStatus',grid,{ids:grid.getSelectionsId().join(','),type:'fabric',is_active:0});});grid.on('celldblclick',function(g,td,cellIndex,r){if(!editAct.isDisabled())
editAct.execute();});grid.on('cellcontextmenu',function(g,td,cellIndex,r,tr,rowIndex,e){e.preventDefault();contextMenu.showAt(e.xy);});window.form.on('afterSave',function(){window.hide();grid.load();});window.form.on('afterSetStatus',function(){window.hide();grid.load();});grid.load();return this.callParent(arguments);}});;Ext.define('TCMS.Fabric.Window',{extend:'BASE.Window',requires:['BASE.Window'],constructor:function(config){Ext.apply(this,{title:'Login',height:480,width:400,resizable:false,modal:true,layout:'border',buttonAlign:'center'});return this.callParent(arguments);},initComponent:function(){var _this=this;var uxFormStatus=Ext.create('BASE.ux.FormStatus',{moduleType:'color'});this.comboFabricType=Ext.create('BASE.ComboStatic',{fieldLabel:'Fabric type',name:'fabric_type',store:[['1','ผ้าธรรมดา'],['2','ผ้าแพง']]});this.comboSupplier=Ext.create('BASE.ComboAjax',{fieldLabel:'Supplier',name:'supplier_id',proxyExtraParams:{type:'supplier'}});this.comboFabricType=Ext.create('BASE.ComboStatic',{fieldLabel:'Stock type',name:'stock_type',store:[['1','Running'],['2','Finite']],});this.comboPrimaryColor=Ext.create('BASE.ComboAjax',{fieldLabel:'Primary color',name:'primary_color_id',proxyExtraParams:{type:'color'},proxySorters:[{property:'name',direction:'ASC'}]});this.comboSecondaryColor=Ext.create('BASE.ComboAjax',{fieldLabel:'Secondary color',name:'secondary_color_id',proxyExtraParams:{type:'color'},proxySorters:[{property:'name',direction:'ASC'}],allowBlank:true});this.comboTertiaryColor=Ext.create('BASE.ComboAjax',{fieldLabel:'Tertiary color',name:'tertiary_color_id',proxyExtraParams:{type:'color'},proxySorters:[{property:'name',direction:'ASC'}],allowBlank:true});this.comboTrueColor=Ext.create('BASE.ComboAjax',{fieldLabel:'True color',name:'true_color_id',proxyExtraParams:{type:'color'},proxySorters:[{property:'name',direction:'ASC'}],allowBlank:true});this.comboPattern=Ext.create('BASE.ComboAjax',{fieldLabel:'Pattern',name:'pattern_id',proxyExtraParams:{type:'pattern'},allowBlank:true});this.comboTexture=Ext.create('BASE.ComboAjax',{fieldLabel:'Texture',name:'texture_id',proxyExtraParams:{type:'texture'},allowBlank:true});this.comboThreadCount=Ext.create('BASE.ComboAjax',{fieldLabel:'Thread count',name:'thread_count_id',proxyExtraParams:{type:'thread_count'},allowBlank:true});this.form=Ext.create('BASE.Form',{region:'center',defaults:{labelWidth:100,labelAlign:'right',width:300},items:[{name:'code',xtype:'textfield',fieldLabel:'Code',allowBlank:false},this.comboFabricType,this.comboSupplier,this.comboStockType,this.comboFabricType,this.comboPrimaryColor,this.comboSecondaryColor,this.comboSecondaryColor,this.comboTertiaryColor,this.comboTrueColor,this.comboPattern,this.comboTexture,this.comboThreadCount,{name:'length_yards',xtype:'numberfield',fieldLabel:'Length (yards)'},{name:'price',xtype:'numberfield',fieldLabel:'Price'},{name:'cost',xtype:'numberfield',fieldLabel:'Cost'},{name:'is_active',xtype:'checkboxfield',fieldLabel:'Active',checked:!0}],plugins:[uxFormStatus],mapping:function(o){var checkComboArr=['primary_color_id','secondary_color_id','tertiary_color_id','true_color_id','pattern_id','texture_id','thread_count_id'];for(var i=0;i<checkComboArr.length;i++){if(Ext.isEmpty(o[checkComboArr[i]])){delete o[checkComboArr[i]];}}
o.is_active=(o.is_active&&o.is_active=='on')?1:0;return o;},getSaveParams:function(){return Ext.apply({type:'fabric'},this.formParams);},getSaveUrl:function(){return __site_url+'backend/icode/'+((_this.dialogAction=="add")?'insert':'update');},getLoadParams:function(){return Ext.apply({type:'fabric'},this.formParams);},getLoadUrl:function(){return __site_url+'backend/dao/load';}});this.submitAct=Ext.create('BASE.Action',{text:'Submit'});this.cancelAct=Ext.create('BASE.Action',{text:'Cancel'});this.buttons=[new Ext.button.Button(this.submitAct),new Ext.button.Button(this.cancelAct)];this.items=[this.form];this.submitAct.setHandler(function(){_this.form.saveData();});this.cancelAct.setHandler(function(){_this.hide();});this.form.on('form_key_enter',function(){_this.submitAct.execute();});this.on("show",function(){_this.form.getEl().scrollTo('top',0,false);_this.form.formParams=_this.dialogParams;_this.form.formAction=_this.dialogAction;_this.actions[_this.dialogAction].call(_this);});return this.callParent(arguments);},actions:{"add":function(){this.form.form.reset();},"edit":function(){this.form.form.reset();this.form.loadData();},"delete":function(){var _this=this;this.hide(null,function(){_this.form.deleteData();});},"setStatus":function(){var _this=this;this.hide(null,function(){_this.form.setStatus();});}}});;Ext.define('TCMS.StyleCollection.Grid',{extend:'BASE.Grid',constructor:function(config){return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:'style_collection'}},fields:[{name:'id',type:'string'},{name:'part_type',type:'string'},'name',{name:'conflict_type',type:'string'},{name:'remark',type:'string'},{name:'is_active',type:'boolean'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Code",width:110,dataIndex:'id',sortable:true,align:'left'},{text:"Type",width:70,dataIndex:'part_type',sortable:true,align:'left',renderer:function(v){var types={COLLAR:'Collar',CUFF:'Cuff',PLACKET:'Placket',POCKET:'Pocket',BOTTOM:'Bottom',YOKE:'Yoke',PLEAT:'Pleat'};return types[v];}},{text:"Name",width:120,dataIndex:'name',sortable:true,align:'left'},{text:"Conflict type",width:160,dataIndex:'conflict_type',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.bbar={xtype:'pagingtoolbar',store:this.store,displayInfo:true};this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.StyleCollection.Main',{extend:'Ext.panel.Panel',constructor:function(config){Ext.apply(this,{layout:'border'});return this.callParent(arguments);},initComponent:function(){var addAct=Ext.create('BASE.Action',{text:'Add',iconCls:'b-application_add'});var editAct=Ext.create('BASE.ActionSingle',{text:'Edit',iconCls:'b-application_edit'});var activeAct=Ext.create('BASE.ActionMultiple',{text:'Active',iconCls:'b-flag-green'});var inActiveAct=Ext.create('BASE.ActionMultiple',{text:'Inactive',iconCls:'b-flag-red'});var contextMenu=new Ext.menu.Menu({items:[addAct,editAct,'-',activeAct,inActiveAct]});var window=Ext.create('TCMS.StyleCollection.Window');var grid=Ext.create('TCMS.StyleCollection.Grid',{region:'center',border:false,tbar:[addAct,editAct,'-',activeAct,inActiveAct],validateActions:[addAct,editAct,activeAct,inActiveAct]});this.items=[grid];addAct.setHandler(function(){window.openDialog('Add style collection','add',grid,{type:'style_collection'});});editAct.setHandler(function(){window.openDialog('Edit style collection','edit',grid,{id:grid.getSelectedId(),type:'style_collection'});});activeAct.setHandler(function(){window.openDialog('Active','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:1});});inActiveAct.setHandler(function(){window.openDialog('Inactive','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:0});});grid.on('celldblclick',function(g,td,cellIndex,r){if(!editAct.isDisabled())
editAct.execute();});grid.on('cellcontextmenu',function(g,td,cellIndex,r,tr,rowIndex,e){e.preventDefault();contextMenu.showAt(e.xy);});window.form.on('afterSave',function(){window.hide();grid.load();});window.form.on('afterSetStatus',function(){window.hide();grid.load();});grid.load();return this.callParent(arguments);}});;Ext.define('TCMS.StyleCollection.Form',{extend:'BASE.Form',requires:['BASE.Form'],constructor:function(config){var _this=this;var uxFormStatus=Ext.create('BASE.ux.FormStatus',{moduleType:'inventory'});Ext.apply(this,{bodyStyle:'padding:5px 0px 0px 0px;',autoScroll:true,plugins:[uxFormStatus],mapping:function(o){o.is_active=(o.is_active&&o.is_active=='on')?1:0;return o;},getSaveParams:function(){return Ext.apply({},this.formParams);},getSaveUrl:function(){return __site_url+'backend/icode/'+((_this.dialogAction=="add")?'insert':'update');},getLoadParams:function(){return Ext.apply({},this.formParams);},getLoadUrl:function(){return __site_url+'backend/dao/load';}});return this.callParent(arguments);},initComponent:function(){var _this=this;var _fieldDefaults={labelAlign:'right',anchor:'100%',labelWidth:70};var _createField=function(ns,config){return Ext.create(ns,Ext.apply(config,_fieldDefaults));};this.comboStyleType=_createField('BASE.ComboStatic',{fieldLabel:'Style type',name:'style_type',store:[[1,'Base style'],[2,'Trend style']]});this.comboPartCollar=_createField('TCMS.BaseMaster.field.ComboPart',{fieldLabel:'Collar',name:'part_collar_id',partType:'COLLAR',allowBlank:true});this.comboPartCollarType=_createField('BASE.ComboStatic',{fieldLabel:'Type',name:'part_collar_type',store:[[1,'ปกนูน'],[2,'ปกธรรมดา']],allowBlank:true});this.numberCollarWidth=_createField('TCMS.BaseMaster.field.Numeric',{fieldLabel:'Width',name:'part_collar_width',allowBlank:true});this.comboPartCollarStay=_createField('BASE.ComboStatic',{fieldLabel:'Stay',name:'part_collar_type',store:[['1','Yes'],['0','No']],allowBlank:true});this.comboPartCuff=_createField('TCMS.BaseMaster.field.ComboPart',{fieldLabel:'Cuff',name:'part_cuff_id',partType:'CUFF',allowBlank:true});this.comboPartCuffType=_createField('BASE.ComboStatic',{fieldLabel:'Type',name:'part_cuff_type',store:[[1,'ข้อมือนูน'],[2,'ข้อมือธรรมดา']],allowBlank:true});this.numberCuffWidth=_createField('TCMS.BaseMaster.field.Numeric',{fieldLabel:'Width',name:'part_cuff_width',allowBlank:true});this.numberCuffThickness=_createField('TCMS.BaseMaster.field.Numeric',{fieldLabel:'Thickness',name:'part_cuff_thickness',allowBlank:true});this.comboPartPlacket=_createField('TCMS.BaseMaster.field.ComboPart',{fieldLabel:'Placket',name:'part_placket_id',partType:'PLACKET',allowBlank:true});this.numberPlacketWidth=_createField('TCMS.BaseMaster.field.Numeric',{fieldLabel:'Width',name:'part_placket_width',allowBlank:true});this.comboPartPocket=_createField('TCMS.BaseMaster.field.ComboPart',{fieldLabel:'Pocket',name:'part_pocket_id',partType:'POCKET',allowBlank:true});this.comboPartYoke=_createField('TCMS.BaseMaster.field.ComboPart',{fieldLabel:'Yoke',name:'part_yoke_id',partType:'YOKE',allowBlank:true});this.comboPartPleat=_createField('TCMS.BaseMaster.field.ComboPart',{fieldLabel:'Pleat',name:'part_pleat_id',partType:'PLEAT',allowBlank:true});this.comboPartBottom=_createField('TCMS.BaseMaster.field.ComboPart',{fieldLabel:'Bottom',name:'part_bottom_id',partType:'BOTTOM',allowBlank:true});this.comboStitchingType=_createField('BASE.ComboStatic',{fieldLabel:'Stitching',name:'stitching_type',store:[[1,'เย็บริม'],[2,'เย็บธรรมดา']],allowBlank:true});this.comboInventoryButton=_createField('TCMS.BaseMaster.field.ComboInventory',{fieldLabel:'Button',name:'inventory_botton_id',inventoryType:'1',allowBlank:true});this.comboInventoryLabel=_createField('TCMS.BaseMaster.field.ComboInventory',{fieldLabel:'Label',name:'inventory_label_id',inventoryType:'2',allowBlank:true});this.comboInventoryPackage=_createField('TCMS.BaseMaster.field.ComboInventory',{fieldLabel:'Package',name:'inventory_packaging_id',inventoryType:'4',allowBlank:true});this.items=[{layout:'column',border:false,defaults:{columnWidth:0.5,layout:'form',border:false,xtype:'panel',bodyStyle:'padding:0 22px 0 0'},items:[{defaults:_fieldDefaults,items:[{name:'code',xtype:'textfield',fieldLabel:'Code',allowBlank:false},this.comboStyleType,{xtype:'fieldset',title:'Collar',defaults:_fieldDefaults,items:[this.comboPartCollar,this.comboPartCuffType,this.numberCollarWidth,this.comboPartCollarStay]},{xtype:'fieldset',title:'Placket',defaults:_fieldDefaults,items:[this.comboPartPlacket,this.numberPlacketWidth]},this.comboStitchingType,{xtype:'fieldset',title:'Inventory',defaults:_fieldDefaults,items:[this.comboInventoryButton,this.comboInventoryLabel,this.comboInventoryPackage]}]},{defaults:_fieldDefaults,items:[{name:'detail',xtype:'textarea',fieldLabel:'Detail',rows:3},{xtype:'fieldset',title:'Cuff',defaults:_fieldDefaults,items:[this.comboPartCuff,this.comboPartCollarType,this.numberCuffWidth,this.numberCuffThickness]},{xtype:'fieldset',title:'Other parts',defaults:_fieldDefaults,items:[this.comboPartPocket,this.comboPartYoke,this.comboPartPleat,this.comboPartBottom]},{name:'remark',xtype:'textarea',fieldLabel:'Remark',rows:3}]}]}];return this.callParent(arguments);}});;Ext.define('TCMS.StyleCollection.Window',{extend:'BASE.Window',requires:['BASE.Window'],constructor:function(config){Ext.apply(this,{title:'Login',height:520,width:600,resizable:false,modal:true,layout:'border',buttonAlign:'center'});return this.callParent(arguments);},initComponent:function(){var _this=this;this.submitAct=Ext.create('BASE.Action',{text:'Submit'});this.cancelAct=Ext.create('BASE.Action',{text:'Cancel'});this.form=Ext.create('TCMS.StyleCollection.Form',{region:'center'});this.buttons=[new Ext.button.Button(this.submitAct),new Ext.button.Button(this.cancelAct)];this.items=[this.form];this.submitAct.setHandler(function(){_this.form.saveData();});this.cancelAct.setHandler(function(){_this.hide();});this.form.on('form_key_enter',function(){_this.submitAct.execute();});this.on("show",function(){_this.form.getEl().scrollTo('top',0,false);_this.form.formParams=_this.dialogParams;_this.form.formAction=_this.dialogAction;_this.actions[_this.dialogAction].call(_this);});return this.callParent(arguments);},actions:{"add":function(){this.form.form.reset();},"edit":function(){this.form.form.reset();this.form.loadData();},"delete":function(){var _this=this;this.hide(null,function(){_this.form.deleteData();});},"setStatus":function(){var _this=this;this.hide(null,function(){_this.form.setStatus();});}}});;Ext.define('TCMS.Inventory.Grid',{extend:'BASE.Grid',constructor:function(config){return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:'inventory'}},fields:[{name:'id',type:'string'},{name:'inventory_type',type:'int'},'name',{name:'inventory_count',type:'float'},{name:'is_active',type:'boolean'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Code",width:60,dataIndex:'id',sortable:true,align:'left'},{text:"Type",width:70,dataIndex:'inventory_type',sortable:true,align:'left',renderer:function(v){var types={1:'Button',2:'Collar',3:'Label',4:'Package'};return types[v];}},{text:"Name",width:120,dataIndex:'name',sortable:true,align:'left'},{text:"Count",width:80,dataIndex:'inventory_count',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.bbar={xtype:'pagingtoolbar',store:this.store,displayInfo:true};this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.Inventory.Main',{extend:'Ext.panel.Panel',constructor:function(config){Ext.apply(this,{layout:'border'});return this.callParent(arguments);},initComponent:function(){var addAct=Ext.create('BASE.Action',{text:'Add',iconCls:'b-application_add'});var editAct=Ext.create('BASE.ActionSingle',{text:'Edit',iconCls:'b-application_edit'});var activeAct=Ext.create('BASE.ActionMultiple',{text:'Active',iconCls:'b-flag-green'});var inActiveAct=Ext.create('BASE.ActionMultiple',{text:'Inactive',iconCls:'b-flag-red'});var contextMenu=new Ext.menu.Menu({items:[addAct,editAct,'-',activeAct,inActiveAct]});var window=Ext.create('TCMS.Inventory.Window');var grid=Ext.create('TCMS.Inventory.Grid',{region:'center',border:false,tbar:[addAct,editAct,'-',activeAct,inActiveAct],validateActions:[addAct,editAct,activeAct,inActiveAct]});this.items=[grid];addAct.setHandler(function(){window.openDialog('Add inventory','add',grid,{type:'inventory'});});editAct.setHandler(function(){window.openDialog('Edit inventory','edit',grid,{id:grid.getSelectedId(),type:'inventory'});});activeAct.setHandler(function(){window.openDialog('Active','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:1});});inActiveAct.setHandler(function(){window.openDialog('Inactive','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:0});});grid.on('celldblclick',function(g,td,cellIndex,r){if(!editAct.isDisabled())
editAct.execute();});grid.on('cellcontextmenu',function(g,td,cellIndex,r,tr,rowIndex,e){e.preventDefault();contextMenu.showAt(e.xy);});window.form.on('afterSave',function(){window.hide();grid.load();});window.form.on('afterSetStatus',function(){window.hide();grid.load();});grid.load();return this.callParent(arguments);}});;Ext.define('TCMS.Inventory.Window',{extend:'BASE.Window',requires:['BASE.Window'],constructor:function(config){Ext.apply(this,{title:'Login',height:220,width:400,resizable:false,modal:true,layout:'border',buttonAlign:'center'});return this.callParent(arguments);},initComponent:function(){var _this=this;var uxFormStatus=Ext.create('BASE.ux.FormStatus',{moduleType:'inventory'});this.comboInventoryType=Ext.create('BASE.ComboStatic',{fieldLabel:'Type',name:'inventory_type',store:[['1','Button'],['2','Collar'],['3','Label'],['4','Package']]});this.form=Ext.create('BASE.Form',{region:'center',defaults:{labelWidth:100,labelAlign:'right',width:300},items:[{name:'code',xtype:'textfield',fieldLabel:'Code',allowBlank:false},this.comboInventoryType,{name:'name',xtype:'textfield',fieldLabel:'Name',allowBlank:false},{name:'inventory_count',xtype:'numberfield',fieldLabel:'Count'},{name:'is_active',xtype:'checkboxfield',fieldLabel:'Active',checked:!0}],plugins:[uxFormStatus],mapping:function(o){o.is_active=(o.is_active&&o.is_active=='on')?1:0;return o;},getSaveParams:function(){return Ext.apply({type:'inventory'},this.formParams);},getSaveUrl:function(){return __site_url+'backend/icode/'+((_this.dialogAction=="add")?'insert':'update');},getLoadParams:function(){return Ext.apply({type:'inventory'},this.formParams);},getLoadUrl:function(){return __site_url+'backend/dao/load';}});this.submitAct=Ext.create('BASE.Action',{text:'Submit'});this.cancelAct=Ext.create('BASE.Action',{text:'Cancel'});this.buttons=[new Ext.button.Button(this.submitAct),new Ext.button.Button(this.cancelAct)];this.items=[this.form];this.submitAct.setHandler(function(){_this.form.saveData();});this.cancelAct.setHandler(function(){_this.hide();});this.form.on('form_key_enter',function(){_this.submitAct.execute();});this.on("show",function(){_this.form.getEl().scrollTo('top',0,false);_this.form.formParams=_this.dialogParams;_this.form.formAction=_this.dialogAction;_this.actions[_this.dialogAction].call(_this);});return this.callParent(arguments);},actions:{"add":function(){this.form.form.reset();},"edit":function(){this.form.form.reset();this.form.loadData();},"delete":function(){var _this=this;this.hide(null,function(){_this.form.deleteData();});},"setStatus":function(){var _this=this;this.hide(null,function(){_this.form.setStatus();});}}});;Ext.define('TCMS.StyleGroup.Grid',{extend:'BASE.Grid',constructor:function(config){return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:'style_group'}},fields:[{name:'id',type:'int'},'name','alias',{name:'is_active',type:'int'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Name",width:120,dataIndex:'name',sortable:true,align:'left'},{text:"Alias",width:80,dataIndex:'alias',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.bbar={xtype:'pagingtoolbar',store:this.store,displayInfo:true};this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.StyleGroup.Main',{extend:'Ext.panel.Panel',constructor:function(config){Ext.apply(this,{layout:'border',border:false});return this.callParent(arguments);},initComponent:function(){var addAct=Ext.create('BASE.Action',{text:'Add',iconCls:'b-application_add'});var editAct=Ext.create('BASE.ActionSingle',{text:'Edit',iconCls:'b-application_edit'});var activeAct=Ext.create('BASE.ActionMultiple',{text:'Active',iconCls:'b-flag-green'});var inActiveAct=Ext.create('BASE.ActionMultiple',{text:'Inactive',iconCls:'b-flag-red'});var contextMenu=new Ext.menu.Menu({items:[addAct,editAct,'-',activeAct,inActiveAct]});var window=Ext.create('TCMS.StyleGroup.Window');var grid=Ext.create('TCMS.StyleGroup.Grid',{region:'center',tbar:[addAct,editAct,'-',activeAct,inActiveAct],validateActions:[addAct,editAct,activeAct,inActiveAct]});this.items=[grid];addAct.setHandler(function(){window.openDialog('Add base style group','add',grid,{type:'style_group'});});editAct.setHandler(function(){window.openDialog('Edit base style group','edit',grid,{id:grid.getSelectedId(),type:'style_group'});});activeAct.setHandler(function(){window.openDialog('Active','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:1});});inActiveAct.setHandler(function(){window.openDialog('Inactive','setStatus',grid,{ids:grid.getSelectionsId().join(','),is_active:0});});grid.on('celldblclick',function(g,td,cellIndex,r){if(!editAct.isDisabled())
editAct.execute();});grid.on('cellcontextmenu',function(g,td,cellIndex,r,tr,rowIndex,e){e.preventDefault();contextMenu.showAt(e.xy);});window.form.on('afterSave',function(){window.hide();grid.load();});window.form.on('afterSetStatus',function(){window.hide();grid.load();});grid.load();return this.callParent(arguments);}});;Ext.define('TCMS.StyleGroup.Fabric.Grid',{extend:'BASE.Grid',constructor:function(config){Ext.apply(this,{disablePaging:true});return this.callParent(arguments);},initComponent:function(){var _this=this;this.store=new Ext.data.JsonStore({proxy:{type:'ajax',url:__site_url+"backend/dao/loadlist",reader:{type:'json',root:'rows',totalProperty:'totalCount',idProperty:'id'},simpleSortMode:true,extraParams:{type:'v_fabric'}},fields:[{name:'id',type:'string'},{name:'fabric_type',type:'int'},{name:'fabric_type_name',type:'string'},'name','alias',{name:'supplier_id',type:'int'},{name:'supplier_name',type:'string'},{name:'stock_type',type:'int'},{name:'stock_type_name',type:'string'},{name:'primary_color_id',type:'int'},{name:'primary_color_name',type:'string'},{name:'secondary_color_id',type:'int'},{name:'secondary_color_name',type:'string'},{name:'tertiary_color_id',type:'int'},{name:'tertiary_color_name',type:'string'},{name:'true_color_id',type:'int'},{name:'true_color_name',type:'string'},{name:'pattern_id',type:'int'},{name:'pattern_name',type:'string'},{name:'texture_id',type:'int'},{name:'texture_name',type:'string'},{name:'thread_count_id',type:'int'},{name:'thread_count_name',type:'string'},{name:'length_yards',type:'float'},{name:'price',type:'float'},{name:'cost',type:'float'},{name:'is_active',type:'boolean'},{name:'create_date',type:'date',dateFormat:'Y-m-d H:i:s'},'create_by',{name:'update_date',type:'date',dateFormat:'Y-m-d H:i:s'},'update_by'],remoteSort:true,sorters:[{property:'id',direction:'ASC'}],pageSize:25});this.columns=[new Ext.grid.RowNumberer(),{text:"Code",width:80,dataIndex:'id',sortable:true,align:'left'},{text:"Fabric Type",width:80,dataIndex:'fabric_type_name',sortable:true,align:'left'},{text:"Supplier",width:100,dataIndex:'supplier_name',sortable:true,align:'left'},{text:"Stock Type",width:80,dataIndex:'stock_type_name',sortable:true,align:'left'},{text:"Primary color",width:80,dataIndex:'primary_color_name',sortable:true,align:'left'},{text:"Secondary color",width:80,dataIndex:'secondary_color_name',sortable:true,align:'left'},{text:"Tertiary color",width:80,dataIndex:'tertiary_color_name',sortable:true,align:'left'},{text:"True color",width:80,dataIndex:'true_color_name',sortable:true,align:'left'},{text:"Pattern",width:80,dataIndex:'pattern_name',sortable:true,align:'left'},{text:"Texture",width:80,dataIndex:'texture_name',sortable:true,align:'left'},{text:"Thread count",width:80,dataIndex:'thread_count_name',sortable:true,align:'left'},{text:"Length(yard)",width:80,dataIndex:'length_yards',sortable:true,align:'left'},{text:"Price",width:60,dataIndex:'price',sortable:true,align:'left'},{text:"cost",width:60,dataIndex:'cost',sortable:true,align:'left'},{text:"Create date",width:120,dataIndex:'create_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Create by",width:100,dataIndex:'create_by',sortable:true,align:'left'},{text:"Update date",width:120,dataIndex:'update_date',sortable:true,align:'left',renderer:function(v){return(v)?Ext.Date.format(v,'d/m/Y H:i:s'):'-';}},{text:"Update by",width:100,dataIndex:'update_by',sortable:true,align:'left'}];this.store.on("beforeload",function(store,opts){opts.params=opts.params||{};if(opts.params){}});return this.callParent(arguments);}});;Ext.define('TCMS.StyleGroup.Window',{extend:'BASE.Window',requires:['BASE.Window'],constructor:function(config){Ext.apply(this,{title:'Login',height:380,width:600,resizable:false,modal:true,layout:'border',buttonAlign:'center',border:false});return this.callParent(arguments);},initComponent:function(){var _this=this;var uxFormStatus=Ext.create('BASE.ux.FormStatus',{moduleType:'color'});this.fabricGrid=Ext.create('TCMS.StyleGroup.Fabric.Grid',{region:'east',width:300,border:true,split:true});this.form=Ext.create('BASE.Form',{region:'center',border:true,defaults:{labelWidth:60,labelAlign:'right',width:250},items:[{name:'name',xtype:'textfield',fieldLabel:'Name',allowBlank:false},{name:'alias',xtype:'textfield',fieldLabel:'Alias',allowBlank:false},{name:'is_active',xtype:'checkboxfield',fieldLabel:'Active',checked:!0}],plugins:[uxFormStatus],mapping:function(o){o.is_active=(o.is_active&&o.is_active=='on')?1:0;return o;},getSaveParams:function(){return Ext.apply({},this.formParams);},getSaveUrl:function(){return __site_url+'backend/dao/'+((_this.dialogAction=="add")?'insert':'update');},getLoadParams:function(){return Ext.apply({},this.formParams);},getLoadUrl:function(){return __site_url+'backend/dao/load';}});this.submitAct=Ext.create('BASE.Action',{text:'Submit'});this.cancelAct=Ext.create('BASE.Action',{text:'Cancel'});this.buttons=[new Ext.button.Button(this.submitAct),new Ext.button.Button(this.cancelAct)];this.items=[this.form,this.fabricGrid];this.submitAct.setHandler(function(){_this.form.saveData();});this.cancelAct.setHandler(function(){_this.hide();});this.form.on('form_key_enter',function(){_this.submitAct.execute();});this.on("show",function(){_this.form.getEl().scrollTo('top',0,false);_this.form.formParams=_this.dialogParams;_this.form.formAction=_this.dialogAction;_this.actions[_this.dialogAction].call(_this);});return this.callParent(arguments);},actions:{"add":function(){this.form.form.reset();},"edit":function(){this.form.form.reset();this.form.loadData();},"delete":function(){var _this=this;this.hide(null,function(){_this.form.deleteData();});},"setStatus":function(){var _this=this;this.hide(null,function(){_this.form.setStatus();});}}});